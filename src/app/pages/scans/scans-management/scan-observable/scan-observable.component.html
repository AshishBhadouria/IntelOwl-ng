<div class="row d-flex justify-content-center p-2">

    <nb-card>
      <nb-card-body class="p-4">
        <form #ipForm=ngForm class="form form-horizontal">
          <div class="row">
  
            <div class="col-12">

              <nb-radio-group [(ngModel)]="formData.classifier" class="d-flex justify-content-start"
                                  name="classifier">
                  <nb-radio value="ip">IP</nb-radio>
                  <nb-radio value="url">URL</nb-radio>
                  <nb-radio value="domain">Domain</nb-radio>
                  <nb-radio value="hash">Hash</nb-radio>

              </nb-radio-group>
  
              <div *ngIf="formData.classifier==='ip'" class="form-group">
                <label class="label form-control-label">Enter IP Address To Scan</label>
                <input pattern="[.0-9]*" #value=ngModel [(ngModel)]="formData.value" fullWidth minlength="8" name="value" nbInput
                  required="true" placeholder="127.0.0.1" shape="rectangle" type="text">
  
                <div *ngIf="value.invalid && (value.dirty || value.touched)" class="alert alert-danger mt-3">
  
                  <div *ngIf="value.errors.required">
                    IP Address is required.
                  </div>
                  <div *ngIf="value.errors.minlength">
                    IP Address must be at least 8 characters long.
                  </div>
                </div>
              </div>
  
              <div *ngIf="formData.classifier!=='ip'" class="form-group">
                <label class="label form-control-label">Enter {{ formData.classifier | ngxCapitalize }} To Scan</label>
                <input #value=ngModel [(ngModel)]="formData.value" fullWidth min="3" name="value"
                  nbInput required="true" shape="rectangle" type="text">
  
                <div *ngIf="value.invalid && (value.dirty || value.touched)"
                  class="alert alert-danger mt-3">
  
                  <div *ngIf="value.errors.required">
                    Value is required.
                  </div>
                  <div *ngIf="value.errors.min">
                    Value must be at least 3 characters long.
                  </div>
  
                </div>
  
              </div> 
  
              <div class="form-group">
                <label class="label form-control-label">Select Analyzers</label>
                <nb-select required="true" name="analyzers" placeholder="Analyzers To Request" 
                outline fullWidth multiple
                [(selected)]="formData.analyzers_list">
                  <nb-option *ngFor="let analyzer of ip_analyzers_list" [value]="analyzer">{{ analyzer }}</nb-option>
                </nb-select>
              </div>

                <nb-checkbox class="col-4" [(ngModel)]="formData.force_privacy"
                    name="force_privacy">disable analyzers that could impact privacy
                </nb-checkbox>
                
                <nb-checkbox class="col-4" [(ngModel)]="formData.disable_external_analyzers"
                    name="disable_external_analyzers">disable analyzers that use external services
                </nb-checkbox>
          </div>
  
          </div>
        </form>
      </nb-card-body>
      <nb-card-footer>
        <button class="col-3" (click)="scan()" [disabled]="ipForm.form.invalid" nbButton status="primary">Start Scan
        </button>
      </nb-card-footer>
    </nb-card>
  
    <nb-card>
      <nb-card-body class="json-background">
        <pre class="text-white" >{{ formData | json }}</pre>
      </nb-card-body>
    </nb-card>
  
  </div>